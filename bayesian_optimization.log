nohup: ignoring input
Using device: cuda:3
Loading data...
Data Loaded: Train 7613, Val 1904, Test 1049
DEBUG: Unique labels in y_train: [0 1 2 3 4 5 6 7 8 9]

--- Starting Bayesian Optimization ---
|   iter    |  target   | batch_... | activa... |
-------------------------------------------------
| [39m1        [39m | [39m0.8347312[39m | [39m393.53643[39m | [39m2.8511922[39m |
| [39m2        [39m | [39m0.2366050[39m | [39m753.84989[39m | [39m1.7953767[39m |
Traceback (most recent call last):
  File "/nfs/home/kek6109/genetic_bayesian_finetuning/bayesian_optimization.py", line 277, in <module>
    main()
  File "/nfs/home/kek6109/genetic_bayesian_finetuning/bayesian_optimization.py", line 196, in main
    optimizer.maximize(
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/bayes_opt/bayesian_optimization.py", line 322, in maximize
    self.probe(x_probe, lazy=False)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/bayes_opt/bayesian_optimization.py", line 239, in probe
    self._space.probe(params)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/bayes_opt/target_space.py", line 555, in probe
    target = self.target_func(**dict_params)
  File "/nfs/home/kek6109/genetic_bayesian_finetuning/bayesian_optimization.py", line 155, in evaluate_network
    outputs = model(images)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nfs/home/kek6109/genetic_bayesian_finetuning/bayesian_optimization.py", line 54, in forward
    x = self.bn1(x) # Apply Batch Norm before Activation
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/functional.py", line 2811, in batch_norm
    _verify_batch_size(input.size())
  File "/nfs/home/kek6109/.conda/envs/fl_hw3/lib/python3.10/site-packages/torch/nn/functional.py", line 2777, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 128])
